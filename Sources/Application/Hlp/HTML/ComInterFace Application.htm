<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
	<HEAD>
		<TITLE>App Filter</TITLE>
		<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
	</HEAD>
	<BODY BGCOLOR="#ffffff" TEXT="#000000">
		<H3>
			<TABLE style="WIDTH: 722px" cellSpacing="2" cellPadding="5" width="722" bgColor="#ffffff"
				 border="0">
				<TBODY>
					<TR>
						<TD align="left" bgColor="#ccccff">
							<P align="center"><FONT face="Arial" color="red" size="5"><STRONG>BUSMASTER COM interface</STRONG></FONT></P>
						</TD>
					</TR>
					<TR>
						<TD align="left" bgColor="#eeeeff"><FONT size="2" 
     ><SPAN style="FONT-FAMILY: Arial">
									<P><STRONG><FONT size=3>Using BUSMASTER Automation 
      Object:</FONT></STRONG>
										               
										    </P>
      <P><BR>
										User can use all the APIs exposed by BUSMASTER, 
      as COM interface functions in his own application by following 
      ways:&nbsp;&nbsp; </P>
      <P>&nbsp;&nbsp;<STRONG><FONT size=3>FROM VB:</FONT>&nbsp;&nbsp;&nbsp; 
      </STRONG>If the client application is developed&nbsp;using <STRONG>VB </STRONG>the steps 
      are:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
      a: Project-&gt;Add Reference ie.</P>
									<P><IMG src="Images\Reference.bmp"></P>
									<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
      b:Select the CAN_Monitor 1.0 Type Library</P>
									<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
										<IMG src="Images\TypeLib.bmp"></P>
									<P align="center">&nbsp;</P>
									<P><BR>
										&nbsp;Now all the BUSMASTER COM APIs can be used in the client application.Once 
										the VB project is configured to use CAN_Monitor type library, a global variable 
										is needed to be declared and initialised so that the COM server can be 
										accessed.This can be accomplished using following statement:</P>
									<P><STRONG>Dim&nbsp;gCANvasApp 
      As CAN_MonitorApp.Application 
											&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
											Set&nbsp;gCANvasApp&nbsp; = New CAN_MonitorApp.Application</STRONG></P>
									<P>Now the varible gCANvasApp can be used to access 
      all the COM 
      members.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
      ie.For connecting the tool following code is 
      required:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
      <STRONG>gCANvasApp&nbsp; .Connect 1</STRONG>            
										 
										       
										 
										  </P>
      <P><STRONG></STRONG>&nbsp;</P>
      <P><A name=cpp> </P>
      <P>&nbsp;<FONT size=3><STRONG>From C++</STRONG></FONT></P></A>
      <P>Let's start with a very simple C++ application. Make a simple 
      dialog-based application with the class wizard, be it an MFC or an ATL/WTL 
      application. Just make sure that <FONT face=Arial><CODE>:<STRONG><FONT 
      face=Courier>CoInitialize()</FONT></STRONG></CODE> and <CODE><STRONG><FONT 
      face=Courier>CoUninitialize()</FONT></STRONG> </CODE>are called somewhere 
      (that is done automatically in ATL applications). Put a button on the 
      dialog somewhere, wire it up, and put the following in the message handler 
      for the <CODE><STRONG><FONT size=3>BN_CLICKED</FONT></STRONG></CODE> 
      handler:</FONT></P>
      <P><STRONG>HRESULT hr;hr =       ::CoCreateInstance(CLSID_Application, NULL,     
       CLSCTX_LOCAL_SERVER, IID_IApplication, (<SPAN 
      class=cpp-keyword>void</SPAN>**)&amp;m_IApplication);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
      <SPAN 
      class=cpp-keyword>if</SPAN>(SUCCEEDED(hr))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
      &nbsp;{  <SPAN class=cpp-keyword>if</SPAN> (m_IApplication) {    
      m_IApplication-&gt;Connect ( 1 );  }}</STRONG></P>
      <P>In the header for the dialog, declare a member like this:</P>
      <P>IApplication* m_IApplication;</P>
      <P>Now, all you need to do is include the file CAN_Monitor_Interface.h 
      which is provided in the BUSMASTER installation folder.<FONT face=Arial>When 
      you go looking for this file, you'll notice another file:&nbsp; 
      CAN_Monitor_Interface<EM>.c</EM>. This file contains the implementation of 
      the interface and is needed by the linker. So, again, you can copy it, or 
      add it to your project directly.</FONT></P>
      <P> Now, build your application, click the button you've made, and - 
      there is your application! </P>
									<P>&nbsp;</P>
								</SPAN></FONT></TD>
					</TR>
				</TBODY></TABLE>
		</H3>
	</BODY>
</HTML>
